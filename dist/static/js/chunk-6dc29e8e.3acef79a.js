(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6dc29e8e"],{1382:function(e,a,t){a=e.exports=t("2350")(!1),a.push([e.i,"\n#map[data-v-211bf95d]{width:100%;height:100%\n}\n#map .layerlist[data-v-211bf95d]{position:absolute;top:.5rem;left:.5rem;width:4rem;min-height:2rem;background-color:#fff;z-index:999;padding:.2rem\n}\n#map .layerlist .gcontent[data-v-211bf95d]{margin-bottom:.2rem;font-size:.2rem\n}\n#map .layerlist[data-v-211bf95d] .el-checkbox{width:1rem\n}\n#map .legend[data-v-211bf95d]{position:absolute;bottom:.2rem;left:.5rem;width:3.4rem;min-height:1rem;background-color:#fff;z-index:999;padding:.2rem;font-size:.15rem\n}\n#map .legend ul[data-v-211bf95d]{flex-wrap:wrap\n}\n#map .legend ul[data-v-211bf95d],#map .legend ul li[data-v-211bf95d]{display:flex;justify-content:flex-start;align-items:center\n}\n#map .legend ul li[data-v-211bf95d]{width:1.1rem;font-size:.12rem;margin-bottom:.1rem\n}\n#map .legend ul li img[data-v-211bf95d]{width:.2rem;margin-right:.1rem\n}",""])},"447c":function(e,a,t){"use strict";var n=t("44bb"),r=t.n(n);r.a},"44bb":function(e,a,t){var n=t("1382");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var r=t("499e").default;r("140914ca",n,!0,{sourceMap:!1,shadowMode:!1})},"4bb4":function(e,a,t){"use strict";t.r(a);var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"map"}},[t("div",{staticClass:"layerlist"},[e._l(e.layerGroupData,function(a,n){return[t("div",{key:n,staticClass:"gcontent"},[t("el-checkbox",{attrs:{indeterminate:e.isIndeterminate["indete"+n]},on:{change:function(t){return e.handleCheckAllChange(t,a.Name,n)}},model:{value:e.checkAll["checkAll"+n],callback:function(a){e.$set(e.checkAll,"checkAll"+n,a)},expression:"checkAll['checkAll' + i]"}},[e._v(e._s(a.Name))]),t("el-checkbox-group",{on:{change:function(t){return e.handleCheckChange(e.check["check"+n],a.Name,n)}},model:{value:e.check["check"+n],callback:function(a){e.$set(e.check,"check"+n,a)},expression:"check['check' + i]"}},e._l(e.layerData.filter(function(e){return e.Name_view2==a.Name}),function(a,n){return t("el-checkbox",{key:n,attrs:{label:a.Name}},[e._v(e._s(a.Name))])}))],1)]})],2),t("div",{staticClass:"legend"},[t("ul",e._l(e.legendData,function(a,n){return t("li",{key:n},[t("img",{attrs:{src:a.src}}),t("label",[e._v(e._s(a.layerName))])])}))])])},r=[],l=(t("6762"),t("ac6a"),t("cadf"),t("551c"),t("097d"),t("cdd0")),c=t("0b45"),i=t("f96b"),s={data:function(){return{baseurl:"",layerUrl:"",ServerInstanceId:"",layerGroupData:[],layerData:[],isIndeterminate:{},checkAll:{},check:{},legendData:[]}},methods:{getdata:function(){var e=this,a={Page:1,Limit:100,Visible:1};i["a"].post("ServerInstance/Search",a).then(function(t){return 200==t.Code&&(e.baseurl=t.Data[0].BaseUrl,e.ServerInstanceId=t.Data[0].ID),a.Name="",a.ServerInstanceId=e.ServerInstanceId,i["a"].post("BaseMap/Search",a)}).then(function(t){if(200==t.Code)return c["a"].baseMapLayers=[],t.Data.forEach(function(a){c["a"].baseMapLayers.push({id:"TiledLayer",name:"底图",url:e.baseurl+a.Url,type:"tile"})}),a.Name="",a.Visible=1,i["a"].post("LayerGroup/Search",a)}).then(function(t){return 200==t.Code&&(e.layerGroupData=t.Data,e.layerGroupData.forEach(function(a,t){e.$set(e.check,"check"+t,[]),e.$set(e.checkAll,"checkAll"+t,!1),e.$set(e.isIndeterminate,"indete"+t,!1)})),a.Name="",a.Visible=1,a.ServerInstanceId=e.ServerInstanceId,i["a"].post("BaseLayer/Search",a)}).then(function(a){return e.layerData=a.Data,e.layerUrl=e.baseurl+e.layerData[0].Url,e.layerUrl=e.layerUrl.substr(0,e.layerUrl.lastIndexOf("/")),200==a.Code&&l["a"].init("map",function(a){l["a"].loadDynamicLayer(e.layerUrl,!1,"dynamiclayer")}),i["a"].get(e.layerUrl+"/legend?f=pjson",{})}).then(function(a){e.legendData=a.layers,e.legendData.forEach(function(e){e["src"]="data:"+e.legend[0].contentType+";base64,"+e.legend[0].imageData})})},handleCheckAllChange:function(e,a,t){var n=this,r=this.layerData.filter(function(e){return e.Name_view2==a}).map(function(e){return e.Name});n.check["check"+t]=e?r:[],n.isIndeterminate["indete"+t]=!1,n.visibleLayer()},handleCheckChange:function(e,a,t){var n=e.length,r=this.layerData.filter(function(e){return e.Name_view2==a});this.checkAll["checkAll"+t]=n===r.length,this.isIndeterminate["indete"+t]=n>0&&n<r.length,this.visibleLayer()},visibleLayer:function(){var e=this,a=[];e.layerGroupData.forEach(function(t,n){var r=e.check["check"+n];r.forEach(function(e){a.push(e)})});var t=e.layerData.filter(function(e){return a.includes(e.Name)}).map(function(e){return e.Code});l["a"].setMapvisibleLayer(t,"dynamiclayer")}},mounted:function(){this.getdata()}},o=s,d=(t("447c"),t("2877")),u=Object(d["a"])(o,n,r,!1,null,"211bf95d",null);u.options.__file="Map.vue";a["default"]=u.exports}}]);